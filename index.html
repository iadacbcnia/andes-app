updateSuggestions();
            if(!manageModal.classList.contains('hidden')){
                renderManagementList();
            }
            // Si el modal del mapa está abierto y los datos están listos, actualiza los marcadores
            if (!mapModal.classList.contains('hidden') && isDataReady) { // <-- Cambio aquí
                // También asegurar que el mapa ya esté inicializado antes de intentar actualizar marcadores
                if (mapInitialized) {
                    updateMapMarkers();
                }
            }
        }, (error) => console.error("Error listening for places:", error));
    }
                radioPlayer.play().catch(e => console.error("Error al reproducir radio:", e));
        } else {
            radioPlayer.pause();
            radioPlayer.src = ""; // Detener la carga del stream
        }
    });

    radioPlayer.addEventListener('play', () => setRadioState('playing'));
    radioPlayer.addEventListener('pause', () => setRadioState('paused'));
    radioPlayer.addEventListener('error', () => {
        setRadioState('paused');
        radioStatusText.textContent = 'Error de stream';
    });

    // Estado inicial
    setRadioState('paused');


    // --- INICIALIZACIÓN GENERAL ---
    initializeFirebase();
    updateSuggestions();
    
});
</script>

</body>
</html>
